WEBVTT
Kind: captions
Language: en

00:00:00.090 --> 00:00:02.490
The following content is
provided under a Creative

00:00:02.490 --> 00:00:04.030
Commons license.

00:00:04.030 --> 00:00:06.330
Your support will help
MIT OpenCourseware

00:00:06.330 --> 00:00:10.690
continue to offer high-quality,
educational resources for free.

00:00:10.690 --> 00:00:13.320
To make a donation or
view additional materials

00:00:13.320 --> 00:00:17.250
from hundreds of MIT courses,
visit MIT OpenCourseware

00:00:17.250 --> 00:00:18.220
at ocw.mit.edu.

00:00:22.659 --> 00:00:23.825
TROY VAN VOORHIS: All right.

00:00:23.825 --> 00:00:25.100
Well, good morning, everyone.

00:00:25.100 --> 00:00:28.990
Hope you had some at least
rest over the long weekend.

00:00:32.049 --> 00:00:36.290
Looking forward to getting
back to talking about quantum.

00:00:36.290 --> 00:00:39.070
So last time, which
was a whole week ago--

00:00:39.070 --> 00:00:41.680
long time ago--
we started talking

00:00:41.680 --> 00:00:43.660
about electronic structure.

00:00:43.660 --> 00:00:47.012
We talked about the Born
Oppenheimer approximation

00:00:47.012 --> 00:00:48.970
and how that gives us an
electronic Schrodinger

00:00:48.970 --> 00:00:51.282
equation, how we look for--

00:00:51.282 --> 00:00:53.740
what we're looking for are the
eigenvalues and eigenvectors

00:00:53.740 --> 00:00:55.240
of that Schrodinger
equation, how

00:00:55.240 --> 00:00:59.590
we can get lots of interesting
information out of that.

00:00:59.590 --> 00:01:01.270
And then we broke
it down so that we

00:01:01.270 --> 00:01:03.784
saw that there were going to
be two main knobs that we were

00:01:03.784 --> 00:01:05.200
going to have to
turn when we were

00:01:05.200 --> 00:01:06.520
making our approximations here.

00:01:06.520 --> 00:01:11.170
We were going out to look at
our atomic orbital basis sets

00:01:11.170 --> 00:01:12.760
and how we compute the energy.

00:01:12.760 --> 00:01:15.070
And we spent the
last half of class

00:01:15.070 --> 00:01:17.485
last time talking about
choosing basis sets.

00:01:17.485 --> 00:01:20.080
We came up with
some understanding

00:01:20.080 --> 00:01:23.500
of these strange names that
are written at the bottom here.

00:01:23.500 --> 00:01:25.900
And then today, we're
going to talk about some

00:01:25.900 --> 00:01:28.090
of these ways of
computing the energy.

00:01:28.090 --> 00:01:30.160
And then I'm going to
flip over, and we're

00:01:30.160 --> 00:01:33.160
going to talk about
computational chemistry tools

00:01:33.160 --> 00:01:37.510
and how we sort of assemble
that into doing a calculation.

00:01:37.510 --> 00:01:39.130
But again, the idea
with basis sets

00:01:39.130 --> 00:01:43.180
was that we were
sort of questing

00:01:43.180 --> 00:01:46.660
after this mythical complete
basis set limit where the basis

00:01:46.660 --> 00:01:49.060
set was so big that
it was infinitely

00:01:49.060 --> 00:01:51.280
big, that making
it bigger didn't

00:01:51.280 --> 00:01:52.807
change your answer at all.

00:01:52.807 --> 00:01:54.140
And we never actually get there.

00:01:54.140 --> 00:01:58.091
But if we get close enough,
we decide that's good.

00:01:58.091 --> 00:01:58.590
All right.

00:01:58.590 --> 00:02:01.980
So now we're going to talk today
about computing the energy.

00:02:01.980 --> 00:02:04.080
And thankfully,
most of the methods

00:02:04.080 --> 00:02:06.390
for computing the energy
start from something

00:02:06.390 --> 00:02:09.870
that I believe you are familiar
with already from 5.61.

00:02:09.870 --> 00:02:12.710
You guys talked about the
Hartree-Fock approximation?

00:02:12.710 --> 00:02:13.220
Yeah?

00:02:13.220 --> 00:02:13.780
Yeah.

00:02:13.780 --> 00:02:14.430
OK.

00:02:14.430 --> 00:02:16.860
So-- or maybe we talked about--

00:02:16.860 --> 00:02:21.280
did we talk about singled did
we talk about determinants?

00:02:21.280 --> 00:02:21.780
Yes.

00:02:21.780 --> 00:02:22.279
All right.

00:02:22.279 --> 00:02:23.190
So there we go.

00:02:23.190 --> 00:02:25.920
So then we talked
about a determinant.

00:02:25.920 --> 00:02:29.160
The idea of a
determinant is that you

00:02:29.160 --> 00:02:31.274
have a set of orbitals,
they're independent,

00:02:31.274 --> 00:02:32.940
and then you compute
the average energy.

00:02:32.940 --> 00:02:35.429
And so, in one
form or another, I

00:02:35.429 --> 00:02:37.470
would write the energy of
a determinant something

00:02:37.470 --> 00:02:37.969
like this.

00:02:37.969 --> 00:02:41.520
I would say that
there's a piece here

00:02:41.520 --> 00:02:45.567
which is the energy of
each electron by itself.

00:02:45.567 --> 00:02:47.025
So these are
one-electron energies.

00:02:50.100 --> 00:02:52.870
So for every electron in my
system, if I have n electrons,

00:02:52.870 --> 00:02:56.020
I add up the energies of
each of those electrons.

00:02:56.020 --> 00:02:59.590
But then, because my Hamiltonian
has electron-electron repulsion

00:02:59.590 --> 00:03:03.220
terms, I end up with some
additional contributions

00:03:03.220 --> 00:03:04.960
that can't be
assigned to just one

00:03:04.960 --> 00:03:08.170
electron or another electron.

00:03:08.170 --> 00:03:10.540
And those terms are
here in this sum.

00:03:10.540 --> 00:03:16.330
They're pairwise so for
every mu and nu summing

00:03:16.330 --> 00:03:20.470
over independent pairs,
I have a coulomb, term j,

00:03:20.470 --> 00:03:22.700
and an exchange, term k.

00:03:22.700 --> 00:03:25.990
And what these things
show me is that there

00:03:25.990 --> 00:03:33.560
is an average repulsion
here between the electrons.

00:03:33.560 --> 00:03:34.880
The electrons are independent.

00:03:34.880 --> 00:03:36.710
They can't avoid each other.

00:03:36.710 --> 00:03:37.930
But they still interact.

00:03:37.930 --> 00:03:39.880
There's still the
electron-electron repulsion

00:03:39.880 --> 00:03:41.650
between electrons here.

00:03:41.650 --> 00:03:44.150
So that's an energy expression
that, in one form or another,

00:03:44.150 --> 00:03:47.300
should be somewhat familiar,
I think, from things

00:03:47.300 --> 00:03:49.340
you guys have done before.

00:03:49.340 --> 00:03:52.730
The idea of Hartree-Fock
is relatively simple,

00:03:52.730 --> 00:03:54.170
which is we have
an energy, then.

00:03:54.170 --> 00:03:56.150
This is true for any
Slater determinant,

00:03:56.150 --> 00:03:57.222
any set of orbitals.

00:03:57.222 --> 00:03:58.430
So I have some orbitals here.

00:04:01.570 --> 00:04:10.100
And the idea of Hartree-Fock
is to choose the orbitals

00:04:10.100 --> 00:04:11.090
to minimize the energy.

00:04:19.000 --> 00:04:21.370
This independent
particle model energy,

00:04:21.370 --> 00:04:22.370
I want to minimize that.

00:04:22.370 --> 00:04:23.770
I'm going to choose the
orbitals that minimize that.

00:04:23.770 --> 00:04:24.850
And the way I'm going
to do that is I'm

00:04:24.850 --> 00:04:26.270
going to write my orbitals--

00:04:26.270 --> 00:04:31.630
psi mu-- as a sum
over some index, i,

00:04:31.630 --> 00:04:38.870
some coefficients c i mu, times
my basis functions, phi i.

00:04:38.870 --> 00:04:47.160
And I'll just emphasize
that what I have here are

00:04:47.160 --> 00:04:48.960
functions from my
AO basis, the things

00:04:48.960 --> 00:04:50.430
that I talked about
last time, like

00:04:50.430 --> 00:04:57.417
the actual 1s-like, 2s-like,
2p-like, 3p-like orbitals.

00:04:57.417 --> 00:04:59.250
And then on the other
side, what I have here

00:04:59.250 --> 00:05:02.050
are my molecular-like orbitals.

00:05:02.050 --> 00:05:05.040
The molecular orbitals
are linear combinations

00:05:05.040 --> 00:05:09.780
of my atomic orbital
basis functions.

00:05:09.780 --> 00:05:12.949
So that's the general idea
of Hartree-Fock there,

00:05:12.949 --> 00:05:14.990
is that we're just going
to choose these orbitals

00:05:14.990 --> 00:05:18.230
to minimize the energy.

00:05:18.230 --> 00:05:20.810
And because the orbitals are
defined by these coefficients,

00:05:20.810 --> 00:05:23.360
I can think of this
energy as a function

00:05:23.360 --> 00:05:25.430
of the coefficients, c.

00:05:25.430 --> 00:05:27.290
So I can say, all
right, that means

00:05:27.290 --> 00:05:29.600
that I have an
independent particle model

00:05:29.600 --> 00:05:36.297
energy which depends on
these coefficients, c.

00:05:36.297 --> 00:05:37.880
And if I want to
minimize that energy,

00:05:37.880 --> 00:05:39.800
I then need to
look for the places

00:05:39.800 --> 00:05:44.310
where the derivatives
are equal to zero.

00:05:44.310 --> 00:05:47.880
So I take the derivative of
that energy, set it equal to 0.

00:05:47.880 --> 00:05:52.920
Now as you might suspect, if
I look at this expression,

00:05:52.920 --> 00:05:57.510
I have an orbital here, here,
here, here, here, here, here,

00:05:57.510 --> 00:05:59.095
here, here, here.

00:05:59.095 --> 00:06:01.460
I have a lot of orbitals
appearing in there.

00:06:01.460 --> 00:06:02.760
And then I'm going to have
to use the chain rule,

00:06:02.760 --> 00:06:04.218
because every one
of those orbitals

00:06:04.218 --> 00:06:06.010
depends on every one
of the coefficients.

00:06:06.010 --> 00:06:07.290
So I'm going to have a
chain rule expression.

00:06:07.290 --> 00:06:08.440
You might expect
that there's going

00:06:08.440 --> 00:06:10.980
to be a lot of algebra involved
in taking this derivative,

00:06:10.980 --> 00:06:12.150
and there is.

00:06:12.150 --> 00:06:15.540
This is where I get to use my
favorite abbreviation, which

00:06:15.540 --> 00:06:17.320
is ASA.

00:06:17.320 --> 00:06:20.055
ASA stands for
After Some Algebra.

00:06:20.055 --> 00:06:22.270
It means I'm not going to
work through the algebra.

00:06:22.270 --> 00:06:23.145
There's some algebra.

00:06:23.145 --> 00:06:24.810
There's several pages
of lecture notes

00:06:24.810 --> 00:06:26.490
where algebra is gone through.

00:06:26.490 --> 00:06:29.377
After you do the
algebra, you end up

00:06:29.377 --> 00:06:31.710
with the left-hand equation
reducing to an equation that

00:06:31.710 --> 00:06:32.770
looks like this.

00:06:32.770 --> 00:06:38.980
So there is a matrix,
which I will call h,

00:06:38.980 --> 00:06:42.440
and then when I dot that
matrix into a vector, c

00:06:42.440 --> 00:06:47.440
mu, the coefficient vector,
I get some energy, e,

00:06:47.440 --> 00:06:53.600
mu, times the
coefficient vector again.

00:06:53.600 --> 00:06:56.180
So that takes a lot of
algebra to get to that,

00:06:56.180 --> 00:06:58.222
but you can get an equation
that looks like this.

00:06:58.222 --> 00:07:00.513
And that's encouraging,
because this is familiar to me.

00:07:00.513 --> 00:07:01.820
This is an eigenvalue equation.

00:07:09.140 --> 00:07:12.450
And that's nice because I
remember eigenvalue equations

00:07:12.450 --> 00:07:12.950
from--

00:07:12.950 --> 00:07:15.270
I mean, the Schrodinger equation
is an eigenvalue equation.

00:07:15.270 --> 00:07:17.186
So it's nice that when
I do this minimization,

00:07:17.186 --> 00:07:18.770
I get back an
eigenvalue equation.

00:07:18.770 --> 00:07:20.180
That's nice.

00:07:20.180 --> 00:07:25.100
The one complication is
that the Hamiltonian here

00:07:25.100 --> 00:07:27.570
depends on the coefficient, c.

00:07:27.570 --> 00:07:29.540
So it's some
effective Hamiltonian.

00:07:29.540 --> 00:07:31.770
I'm intentionally
collecting terms

00:07:31.770 --> 00:07:33.747
so that it looks like
a Schrodinger equation,

00:07:33.747 --> 00:07:36.080
but it's a little bit funny
because the Hamiltonian here

00:07:36.080 --> 00:07:39.180
depends on the coefficients
that solve the equation.

00:07:39.180 --> 00:07:42.410
So this is sort of an
eigenvalue equation.

00:07:45.990 --> 00:07:54.250
And so what we're seeing
here is that H depends

00:07:54.250 --> 00:07:55.720
on the wave function somehow.

00:07:55.720 --> 00:07:58.280
It seems like, depending on
what the wave function is,

00:07:58.280 --> 00:08:00.370
I have different Hamiltonians.

00:08:00.370 --> 00:08:02.470
And to understand
why this is the case,

00:08:02.470 --> 00:08:08.630
I want us to think
about the potential, v,

00:08:08.630 --> 00:08:13.747
that an electron feels in
an atom or in a molecule.

00:08:13.747 --> 00:08:15.830
And there's generally going
to be two pieces here.

00:08:15.830 --> 00:08:17.220
And they're actually--

00:08:17.220 --> 00:08:19.250
I can color-code
them with the terms

00:08:19.250 --> 00:08:21.410
that exist in the independent
particle expression.

00:08:21.410 --> 00:08:23.720
So there is the
one-electron terms,

00:08:23.720 --> 00:08:26.235
the terms in the energy that
just come from one electron.

00:08:26.235 --> 00:08:28.610
And those are going to be
things like, well, I might have

00:08:28.610 --> 00:08:31.490
a nucleus of charge plus z.

00:08:31.490 --> 00:08:37.020
And I might have my
electron out here, the one

00:08:37.020 --> 00:08:38.580
that I'm interested in.

00:08:38.580 --> 00:08:42.162
And it's going to have some
attraction to that nucleus.

00:08:42.162 --> 00:08:43.620
So that just involves
one electron.

00:08:43.620 --> 00:08:46.330
It involves a nucleus,
but just one electron.

00:08:46.330 --> 00:08:49.780
So there's some
nuclear potential

00:08:49.780 --> 00:08:52.480
that each electron
is going to feel.

00:08:52.480 --> 00:08:55.270
But then there's the
term that correspond

00:08:55.270 --> 00:08:56.840
to these average
repulsion terms.

00:08:56.840 --> 00:09:00.640
So there are other
electrons in my system.

00:09:00.640 --> 00:09:04.780
And each of those electrons
interacts with the electron

00:09:04.780 --> 00:09:07.490
that I'm looking at.

00:09:07.490 --> 00:09:10.900
So there's going to be some
electron-electron repulsion

00:09:10.900 --> 00:09:12.680
term here.

00:09:12.680 --> 00:09:14.860
And that electron-electron
repulsion

00:09:14.860 --> 00:09:17.077
depends on where the
other electrons are.

00:09:17.077 --> 00:09:19.160
And those other electrons
have some wave function.

00:09:19.160 --> 00:09:22.890
They're kind of spread out
here, all over the place.

00:09:22.890 --> 00:09:25.900
And depending on how spread
out those other electrons are,

00:09:25.900 --> 00:09:28.460
I might have more or
less electron repulsion.

00:09:28.460 --> 00:09:30.820
So if they're very, very
concentrated in the region

00:09:30.820 --> 00:09:32.617
that I'm looking at,
the electron repulsion

00:09:32.617 --> 00:09:33.700
is going to be very large.

00:09:33.700 --> 00:09:35.574
If they're very spread
out, and very diffuse,

00:09:35.574 --> 00:09:38.020
they're not going to have
very much electron repulsion.

00:09:38.020 --> 00:09:43.470
But overall, the
electron-electron repulsion

00:09:43.470 --> 00:09:46.710
depends on the wave
functions that I've chosen.

00:09:46.710 --> 00:09:56.354
So the potential here is called
a mean field, or average field.

00:09:56.354 --> 00:09:58.270
And it's because it's
the potential that comes

00:09:58.270 --> 00:09:59.510
from the average repulsion.

00:09:59.510 --> 00:10:02.560
It's the effective potential due
to the averaging, the smearing

00:10:02.560 --> 00:10:05.700
out, over all the
other electrons.

00:10:05.700 --> 00:10:09.290
So what we do have, then,
is that the Hamiltonian

00:10:09.290 --> 00:10:12.530
does into indeed depend
on the wave functions,

00:10:12.530 --> 00:10:14.330
because the wave
functions determine

00:10:14.330 --> 00:10:15.890
that average potential.

00:10:15.890 --> 00:10:17.930
But then if I know
the Hamiltonian,

00:10:17.930 --> 00:10:19.520
I can solve for
the wave functions,

00:10:19.520 --> 00:10:21.920
because the wave functions
are the eigenfunctions

00:10:21.920 --> 00:10:23.250
of the Hamiltonian.

00:10:23.250 --> 00:10:28.231
And so I have this sort of
chicken and egg situation,

00:10:28.231 --> 00:10:30.230
that the Hamiltonian
defines the wave functions,

00:10:30.230 --> 00:10:32.390
and the wave functions
define the Hamiltonian.

00:10:32.390 --> 00:10:34.970
And the solution
to this is to do

00:10:34.970 --> 00:10:37.730
what are called self-consistent
field iterations.

00:10:42.160 --> 00:10:43.910
And you can more or
less think about these

00:10:43.910 --> 00:10:47.420
as the simple process of,
guess some wave functions,

00:10:47.420 --> 00:10:49.790
build the Hamiltonian, get
some new wave functions,

00:10:49.790 --> 00:10:52.016
build a new Hamiltonian,
get some new wave functions,

00:10:52.016 --> 00:10:53.390
build a new
Hamiltonian, and keep

00:10:53.390 --> 00:10:58.040
going until everything
becomes consistent.

00:10:58.040 --> 00:11:00.290
And the idea, then,
is that the wave

00:11:00.290 --> 00:11:03.600
function we're looking
for in Hartree-Fock

00:11:03.600 --> 00:11:15.620
are the eigenfunctions of H of
psi Hf, which we just defined

00:11:15.620 --> 00:11:19.060
to be equal to H Hartree-Fock.

00:11:19.060 --> 00:11:22.410
So there's some
Hartree-Fock Hamiltonian.

00:11:22.410 --> 00:11:23.940
And the Hartree-Fock
wave functions

00:11:23.940 --> 00:11:26.485
are the eigenfunctions
of that Hamiltonian.

00:11:26.485 --> 00:11:28.789
Does that makes sense?

00:11:28.789 --> 00:11:29.830
Any questions about that?

00:11:37.500 --> 00:11:38.050
All right.

00:11:38.050 --> 00:11:40.930
So Hartree-Fock is
the starting point.

00:11:40.930 --> 00:11:43.400
So we have that as
an approximation.

00:11:43.400 --> 00:11:44.890
It's a useful starting point.

00:11:44.890 --> 00:11:47.480
In many cases, Hartree-Fock
is not good enough.

00:11:47.480 --> 00:11:50.410
And so the real thing that
we're trying to figure out

00:11:50.410 --> 00:11:51.850
is, how do we make
something that

00:11:51.850 --> 00:11:54.640
uses what we've learned from
Hartree-Fock about orbitals,

00:11:54.640 --> 00:11:56.470
and energies, and
average repulsion-- how

00:11:56.470 --> 00:12:00.110
do we make something that's
like Hartree-Fock, but better?

00:12:00.110 --> 00:12:02.369
So one way to do
this is something

00:12:02.369 --> 00:12:04.660
that you've spent a lot of
time on this semester, which

00:12:04.660 --> 00:12:06.364
is perturbation theory.

00:12:06.364 --> 00:12:08.780
You have something that's
pretty good as a starting point,

00:12:08.780 --> 00:12:11.050
and you want to make it
better, perturbation theory

00:12:11.050 --> 00:12:14.260
is the natural thing
to turn to do that.

00:12:14.260 --> 00:12:16.150
And so the way we apply
perturbation theory

00:12:16.150 --> 00:12:19.350
in Hartree-Fock is
we say, well, we've

00:12:19.350 --> 00:12:22.020
got this Hartree-Fock
Hamiltonian, which

00:12:22.020 --> 00:12:29.485
we can solve, and then we've
got the actual Hamiltonian, H,

00:12:29.485 --> 00:12:30.360
which we can't solve.

00:12:34.740 --> 00:12:37.490
And so what we can do is
then we say, aha, well

00:12:37.490 --> 00:12:40.580
that means that if I
just take the difference

00:12:40.580 --> 00:12:42.200
between the
Hamiltonian I can solve

00:12:42.200 --> 00:12:43.740
and the Hamiltonian
I can't solve,

00:12:43.740 --> 00:12:45.980
and I treat that
as a perturbation,

00:12:45.980 --> 00:12:49.340
then I can do a well-defined
perturbation theory where

00:12:49.340 --> 00:12:52.160
I know the solutions
to H0, and then I

00:12:52.160 --> 00:12:55.400
treat that additional
term as a perturbation.

00:12:55.400 --> 00:12:57.392
And so then if I
do that, I end up

00:12:57.392 --> 00:12:58.850
with a perturbation
expansion where

00:12:58.850 --> 00:13:01.940
I can go to first, second,
third, fourth, fifth order,

00:13:01.940 --> 00:13:06.630
and that additional term that's
the difference between the two.

00:13:06.630 --> 00:13:10.010
And if I look at the first
two terms added together,

00:13:10.010 --> 00:13:11.690
they give me the
Hartree-Fock energy.

00:13:11.690 --> 00:13:16.460
So if I'm the one making up
a perturbation expansion,

00:13:16.460 --> 00:13:18.470
I will always choose it
so that the first order

00:13:18.470 --> 00:13:20.000
correction is 0.

00:13:20.000 --> 00:13:22.730
So that if otherwise
I have chosen,

00:13:22.730 --> 00:13:25.374
I will just re-engineer my
perturbation so that's true.

00:13:25.374 --> 00:13:27.790
So up through first order, I
just get what I started with.

00:13:27.790 --> 00:13:29.930
I get Hartree-Fock.

00:13:29.930 --> 00:13:34.030
But then I have these
additional terms.

00:13:34.030 --> 00:13:35.470
And so I can go to second order.

00:13:35.470 --> 00:13:37.950
And I will get a
method that I call--

00:13:37.950 --> 00:13:40.330
it's called MP2.

00:13:40.330 --> 00:13:44.490
So Hartree-Fock is named
after Hartree and Fock.

00:13:44.490 --> 00:13:46.730
MP stands for
Moller and Plesset,

00:13:46.730 --> 00:13:50.580
the names of the two people
who wrote the paper in 1938,

00:13:50.580 --> 00:13:53.190
about this particular thing.

00:13:53.190 --> 00:13:55.030
And the 2 is second order.

00:13:55.030 --> 00:14:01.140
And then I could go on, and I
could do MP3, MP4, dot dot dot

00:14:01.140 --> 00:14:02.550
dot dot.

00:14:02.550 --> 00:14:06.570
So in general, this is
MP, and some number, n,

00:14:06.570 --> 00:14:09.690
telling me the order I go
to in perturbation theory.

00:14:09.690 --> 00:14:11.810
So you could do this.

00:14:11.810 --> 00:14:15.660
In principle, this gets
better and better answers.

00:14:15.660 --> 00:14:18.700
However, in practice,
about 20 years ago,

00:14:18.700 --> 00:14:21.510
people discovered something
that was rather disturbing.

00:14:21.510 --> 00:14:25.030
So if I take a look at the
energy minus the [INAUDIBLE]..

00:14:25.030 --> 00:14:28.919
So let's say I have a case
where I know the exact energy.

00:14:28.919 --> 00:14:31.210
And I look at the energy of
these different approximate

00:14:31.210 --> 00:14:35.260
methods for, say, one particular
simple thing, like a neon atom.

00:14:35.260 --> 00:14:37.180
So I take a neon
atom, and I look

00:14:37.180 --> 00:14:41.140
at the energies of these
MPn approximations,

00:14:41.140 --> 00:14:47.091
and I look at them as a function
of n, so 1, 2, 3, 4, 5, 6, 7,

00:14:47.091 --> 00:14:47.590
8.

00:14:52.880 --> 00:14:54.675
And I'll say that for neon--

00:14:54.675 --> 00:14:56.800
neon is something for which
Hartree-Fock is already

00:14:56.800 --> 00:14:57.760
pretty good.

00:14:57.760 --> 00:14:59.380
So the difference
between Hartree-Fock

00:14:59.380 --> 00:15:01.750
and the exact answer
is not too bad.

00:15:01.750 --> 00:15:04.090
So Hartree-Fock
might be, let's say,

00:15:04.090 --> 00:15:06.490
there on this particular scale.

00:15:06.490 --> 00:15:10.023
And then if you do
MP2, MP2 is better.

00:15:10.023 --> 00:15:13.480
So my MP2 is maybe there.

00:15:13.480 --> 00:15:15.280
MP3 is also a little
bit better than that,

00:15:15.280 --> 00:15:17.510
but it overshoots a little bit.

00:15:17.510 --> 00:15:20.050
MP4 corrects back in
the opposite direction.

00:15:20.050 --> 00:15:27.450
And then we've got 5, 6, 7, 8.

00:15:27.450 --> 00:15:29.440
And you can-- if I
connect the dots,

00:15:29.440 --> 00:15:31.680
you can see what's
starting to happen here.

00:15:36.850 --> 00:15:38.059
So that's a series.

00:15:38.059 --> 00:15:39.600
So mathematically,
I've got something

00:15:39.600 --> 00:15:41.760
that there is a value
for everything in n.

00:15:41.760 --> 00:15:42.760
That's a series.

00:15:42.760 --> 00:15:44.340
And the name for
a series like this

00:15:44.340 --> 00:15:46.300
is one that is not converging.

00:15:46.300 --> 00:15:48.750
So there's an answer which
is the infinite order answer,

00:15:48.750 --> 00:15:51.112
but these partial sums
are not converging

00:15:51.112 --> 00:15:52.070
to the infinite answer.

00:15:56.890 --> 00:15:59.490
And very often this turns out
to be the case with perturbation

00:15:59.490 --> 00:16:00.120
theory.

00:16:00.120 --> 00:16:01.536
There can be
perturbation theories

00:16:01.536 --> 00:16:04.170
that are very useful at
low orders for describing

00:16:04.170 --> 00:16:06.090
qualitatively how things shift.

00:16:06.090 --> 00:16:08.490
But if you go out
to infinite order,

00:16:08.490 --> 00:16:12.000
they are series that, in
principle, you can prove,

00:16:12.000 --> 00:16:14.640
give the correct, exact
answer, because we've

00:16:14.640 --> 00:16:16.200
derived it as such.

00:16:16.200 --> 00:16:19.080
But just because a series in
principle sums to something

00:16:19.080 --> 00:16:21.150
doesn't mean that any
finite number of terms

00:16:21.150 --> 00:16:25.440
will give a convergent answer,
or give smaller errors.

00:16:25.440 --> 00:16:28.470
And people find that
for perturbation theory

00:16:28.470 --> 00:16:31.710
for electronic structure
theory, this is--

00:16:31.710 --> 00:16:33.240
not all of the
time, but very often

00:16:33.240 --> 00:16:36.720
the case, that the perturbation
expansion doesn't converge.

00:16:36.720 --> 00:16:39.827
And so this is one
of those places where

00:16:39.827 --> 00:16:41.910
you make a nice empirical
compromise, and you say,

00:16:41.910 --> 00:16:45.330
well, gee, every term--

00:16:45.330 --> 00:16:47.820
it doesn't necessarily
get better after MP2.

00:16:47.820 --> 00:16:50.070
MP2 usually improves
on Hartree-Fock,

00:16:50.070 --> 00:16:52.320
but higher order might
be better or worse.

00:16:52.320 --> 00:16:54.790
And certainly, higher
order is more expensive.

00:16:54.790 --> 00:16:56.940
So MP2 is a good place
to get off the elevator,

00:16:56.940 --> 00:16:59.190
because it's just going to
get more expensive, and not

00:16:59.190 --> 00:17:00.777
necessarily more accurate.

00:17:00.777 --> 00:17:02.110
So this is a good place to stop.

00:17:09.109 --> 00:17:10.790
And so you'll see a
lot of calculations

00:17:10.790 --> 00:17:13.609
out there that are
variations on MP2,

00:17:13.609 --> 00:17:15.020
because it's the
least expensive,

00:17:15.020 --> 00:17:17.780
and it's somewhat more accurate.

00:17:17.780 --> 00:17:20.480
OK so now we're going
to take a pause,

00:17:20.480 --> 00:17:22.460
and we're going to talk--

00:17:22.460 --> 00:17:25.589
and this is where I need
audience participation.

00:17:25.589 --> 00:17:27.980
So we're going to discuss
two different things

00:17:27.980 --> 00:17:29.146
that you might want to know.

00:17:29.146 --> 00:17:31.590
We've now got two methods,
Hartree-Fock and MP2.

00:17:31.590 --> 00:17:33.798
And there are two things
that you might want to know.

00:17:33.798 --> 00:17:36.260
One is, how accurate will
one of these calculations be?

00:17:36.260 --> 00:17:38.135
If I do it, will it give
me the right answer?

00:17:38.135 --> 00:17:40.070
And the other one is,
how long will it take?

00:17:40.070 --> 00:17:41.736
In other words, will
it finish by Friday

00:17:41.736 --> 00:17:43.000
when the P set is due?

00:17:43.000 --> 00:17:45.890
Will it finish by the
end of the semester?

00:17:45.890 --> 00:17:49.010
Will it finish by the
end of my time at MIT?

00:17:49.010 --> 00:17:51.000
What time scale
are we looking at?

00:17:51.000 --> 00:17:53.840
So we'll start off
talking about properties.

00:17:53.840 --> 00:17:56.090
So people have done many,
many, many calculations

00:17:56.090 --> 00:17:58.750
using many different
electronic structure methods,

00:17:58.750 --> 00:18:02.150
so that now there's sort of
an empirical rule of thumb

00:18:02.150 --> 00:18:04.889
for just about any property
you want to know about.

00:18:04.889 --> 00:18:07.430
There's a rule of thumb for how
accurate one of these methods

00:18:07.430 --> 00:18:07.929
should be.

00:18:07.929 --> 00:18:10.910
So what's a property that
you might want to know?

00:18:10.910 --> 00:18:14.089
This is where the audience
participation comes in.

00:18:14.089 --> 00:18:16.130
I will only give you
information about properties

00:18:16.130 --> 00:18:19.570
that you say are interesting.

00:18:19.570 --> 00:18:21.267
AUDIENCE: Time and
space complexity.

00:18:21.267 --> 00:18:23.100
TROY VAN VOORHIS: Time
and space complexity.

00:18:23.100 --> 00:18:23.825
All right.

00:18:23.825 --> 00:18:24.950
Could you be more specific.

00:18:24.950 --> 00:18:27.617
What type of time
and space complexity?

00:18:27.617 --> 00:18:28.450
AUDIENCE: How well--

00:18:28.450 --> 00:18:31.779
I mean, for a size of
molecule, how long it takes--

00:18:31.779 --> 00:18:32.820
TROY VAN VOORHIS: Ah, OK.

00:18:32.820 --> 00:18:34.580
AUDIENCE: --and also
how much space it takes.

00:18:34.580 --> 00:18:36.050
TROY VAN VOORHIS: Yes, so
that will be the second thing

00:18:36.050 --> 00:18:37.165
that we will talk about.

00:18:37.165 --> 00:18:38.540
Those are the two
variables we'll

00:18:38.540 --> 00:18:41.087
talk about, in terms of
how long and how fast.

00:18:41.087 --> 00:18:42.920
I'm interested here,
where I'm saying, like,

00:18:42.920 --> 00:18:44.330
molecular properties--
things you

00:18:44.330 --> 00:18:47.105
might want to know about
a molecule, or a reaction,

00:18:47.105 --> 00:18:49.150
or something like that.

00:18:49.150 --> 00:18:52.220
AUDIENCE: Like the energy of a
molecule in transition state.

00:18:52.220 --> 00:18:58.890
TROY VAN VOORHIS: OK, so that
would be sort of activation

00:18:58.890 --> 00:19:04.390
energy, right/ OK,
what's something else?

00:19:08.907 --> 00:19:10.490
We only want to know
about activation?

00:19:10.490 --> 00:19:11.060
Yeah.

00:19:11.060 --> 00:19:12.130
AUDIENCE: Charge distribution.

00:19:12.130 --> 00:19:13.130
TROY VAN VOORHIS: Right.

00:19:13.130 --> 00:19:15.110
OK, so I'll give one
variable that probes that,

00:19:15.110 --> 00:19:16.693
which is a dipole
moment, for example.

00:19:16.693 --> 00:19:19.010
You might want to
know a dipole moment.

00:19:19.010 --> 00:19:21.227
AUDIENCE: What the MOs
look like [INAUDIBLE]

00:19:21.227 --> 00:19:22.310
TROY VAN VOORHIS: OK, yes.

00:19:22.310 --> 00:19:26.570
So that is something
we want to know about,

00:19:26.570 --> 00:19:28.220
but it's a qualitative one.

00:19:28.220 --> 00:19:29.590
So what I'm going to give is I'm
going to give you things where

00:19:29.590 --> 00:19:31.550
I can say, oh, for
a dipole moment,

00:19:31.550 --> 00:19:33.810
it's within this many
debye, or this much percent.

00:19:33.810 --> 00:19:36.710
So MOs are qualitative, and we
can get that, but I can't say,

00:19:36.710 --> 00:19:40.840
well, this MO is 75% right.

00:19:40.840 --> 00:19:43.690
AUDIENCE: Average distance
of an electron from an atom.

00:19:43.690 --> 00:19:46.865
TROY VAN VOORHIS: OK, so
that would be like size.

00:19:46.865 --> 00:19:47.490
AUDIENCE: Yeah.

00:19:47.490 --> 00:19:49.878
TROY VAN VOORHIS: Yeah, yeah.

00:19:49.878 --> 00:19:51.197
AUDIENCE: [INAUDIBLE].

00:19:51.197 --> 00:19:52.530
TROY VAN VOORHIS: What was that?

00:19:52.530 --> 00:19:53.880
AUDIENCE: Color.

00:19:53.880 --> 00:19:54.970
TROY VAN VOORHIS: Yeah.

00:19:54.970 --> 00:19:57.340
I mean, so yeah, that's
about an absorption--

00:19:57.340 --> 00:19:59.080
like an electronic
absorption spectrum.

00:20:07.140 --> 00:20:09.844
Other things people
might want to know?

00:20:09.844 --> 00:20:10.760
AUDIENCE: Bond length.

00:20:10.760 --> 00:20:11.380
TROY VAN VOORHIS: Bond length.

00:20:11.380 --> 00:20:12.030
There you go.

00:20:16.690 --> 00:20:17.310
Anything else?

00:20:17.310 --> 00:20:18.226
We've got a good list.

00:20:20.990 --> 00:20:23.870
OK, we'll use that as our list.

00:20:23.870 --> 00:20:25.862
OK, so I will start
off with bond lengths,

00:20:25.862 --> 00:20:27.570
because that's the
one where Hartree-Fock

00:20:27.570 --> 00:20:30.320
does the best of these things.

00:20:30.320 --> 00:20:32.970
So it makes you feel
like it's encouraging.

00:20:32.970 --> 00:20:35.580
So bond lengths--
Hartree-Fock usually

00:20:35.580 --> 00:20:38.434
predicts bond lengths to
be a little bit too short.

00:20:38.434 --> 00:20:40.350
So the molecules are a
little bit too compact.

00:20:40.350 --> 00:20:42.000
But it's not too bad.

00:20:42.000 --> 00:20:46.660
They're usually too short by
about 1%, which is not too bad.

00:20:46.660 --> 00:20:50.170
It gets 99% percent of
the bond length right.

00:20:50.170 --> 00:20:53.980
MP2 does better, so
that it doesn't actually

00:20:53.980 --> 00:20:55.590
have a systematic error.

00:20:55.590 --> 00:20:58.120
It typically gets
bond lengths correct,

00:20:58.120 --> 00:21:00.930
plus or minus one picometer.

00:21:00.930 --> 00:21:04.960
So a picometer is 10 to
the minus 12th meters.

00:21:04.960 --> 00:21:08.560
So 0.01 angstroms,
since a bond length

00:21:08.560 --> 00:21:11.680
is usually about an angstrom.

00:21:11.680 --> 00:21:19.330
So we'll go from that to size.

00:21:19.330 --> 00:21:23.980
So for the size of an
atom or a molecule,

00:21:23.980 --> 00:21:26.800
this has to do with the Van
der Waal's radius, basically.

00:21:26.800 --> 00:21:30.550
And actually, Hartree-Fock
does a fairly good job

00:21:30.550 --> 00:21:32.500
of describing Van
der Waal's radii.

00:21:32.500 --> 00:21:37.900
I would say that it more or
less goes with the bond length

00:21:37.900 --> 00:21:40.730
prescription, so that the size
is a little bit too small.

00:21:40.730 --> 00:21:45.860
So it might be minus
2% to 3% to small.

00:21:45.860 --> 00:21:50.440
And then there's very few
people that actually do sizes

00:21:50.440 --> 00:21:52.900
with MP2, for various reasons.

00:21:52.900 --> 00:21:55.060
But I would say that it's--

00:21:59.327 --> 00:22:00.410
I'll put "accurate" there.

00:22:00.410 --> 00:22:04.070
Because basically the size of
an atom or a molecule is fuzzy.

00:22:04.070 --> 00:22:06.650
So I can talk about the radius,
and it's a little bit fuzzy.

00:22:06.650 --> 00:22:08.357
The errors in MP2
would be smaller

00:22:08.357 --> 00:22:10.940
than whatever fuzziness I could
have in my definition of size.

00:22:14.110 --> 00:22:17.210
For activation energies,
Hartree-Fock is pretty poor,

00:22:17.210 --> 00:22:23.820
so the activation barriers here
are too high, by 30% to 50%.

00:22:23.820 --> 00:22:27.080
So the barrier heights are
very high in Hartree-Fock.

00:22:27.080 --> 00:22:28.700
MP2 has barrier
heights that are still

00:22:28.700 --> 00:22:34.400
too high, but only by
about 10% on average.

00:22:34.400 --> 00:22:36.440
Dipole moments in
Hartree-Fock-- there

00:22:36.440 --> 00:22:37.880
are no systematic
studies on that.

00:22:37.880 --> 00:22:40.560
I will just say
that they are bad.

00:22:40.560 --> 00:22:43.640
They are bad enough that
nobody does a systematic study.

00:22:43.640 --> 00:22:49.940
But for MP2, they're quite
a bit better, and typically

00:22:49.940 --> 00:22:51.950
accurate say, 0.1 debye.

00:22:54.830 --> 00:22:59.210
And then for excitation
absorption energy--

00:22:59.210 --> 00:23:01.580
so this is going to be the
difference between the lowest

00:23:01.580 --> 00:23:05.330
electronic state and the next
highest electronic state--

00:23:05.330 --> 00:23:08.840
so you can get these things
through various means.

00:23:08.840 --> 00:23:13.165
The typical absorption-- and
also, I'll say that doing that

00:23:13.165 --> 00:23:15.290
involves an extension beyond
what I've talked about

00:23:15.290 --> 00:23:17.540
so far, because I've been
focused on the ground state.

00:23:17.540 --> 00:23:20.220
But if you use the logical
extensions of these things,

00:23:20.220 --> 00:23:22.940
the absorption energies
in Hartree-Fock

00:23:22.940 --> 00:23:34.560
tend to be too big, and too
big by, say, half an eV or so.

00:23:34.560 --> 00:23:40.560
And then for MP2, they're more
accurate, but not that much.

00:23:40.560 --> 00:23:45.140
So plus or minus, say, 0.3 eV.

00:23:45.140 --> 00:23:48.780
Electronic inside states tend
to be fairly difficult to get.

00:23:48.780 --> 00:23:51.380
But we see that MP2 is doing
better on all accounts,

00:23:51.380 --> 00:23:52.130
than Hartree-Fock.

00:23:52.130 --> 00:23:53.120
So it's improving.

00:23:53.120 --> 00:23:54.470
That's good.

00:23:54.470 --> 00:23:58.400
But then, all right, what
is this going to cost me?

00:23:58.400 --> 00:23:59.930
How long is this going to take?

00:23:59.930 --> 00:24:02.720
Well, there's two different
ways that we can measure

00:24:02.720 --> 00:24:03.890
computational complexity.

00:24:03.890 --> 00:24:06.725
One is by the amount of
storage that's required.

00:24:06.725 --> 00:24:09.710
It's the amount of information
you have to store in order

00:24:09.710 --> 00:24:11.340
to do the calculation.

00:24:11.340 --> 00:24:13.670
The other way is by how
long it's going to take,

00:24:13.670 --> 00:24:17.440
how many operations the computer
has to do to solve the problem.

00:24:17.440 --> 00:24:24.760
And so for Hartree-Fock, the
main memory piece that we need

00:24:24.760 --> 00:24:26.200
is actually the Hamiltonian.

00:24:26.200 --> 00:24:28.210
So we need that
Hamiltonian matrix.

00:24:28.210 --> 00:24:32.770
We've got to store that in order
to compute its eigenvalues.

00:24:32.770 --> 00:24:38.050
And it is an end-- it's a number
of basis functions by number

00:24:38.050 --> 00:24:39.511
of basis functions.

00:24:45.640 --> 00:24:52.060
And so then now we have
to say, all right--

00:24:52.060 --> 00:24:54.660
well, first of all, we have
to figure out how much RAM.

00:24:54.660 --> 00:24:57.470
So when I'm figuring out
how much RAM is required--

00:24:57.470 --> 00:25:02.170
does anybody know how much
RAM they have on their laptop

00:25:02.170 --> 00:25:04.020
or desktop computer?

00:25:04.020 --> 00:25:05.800
Nobody knows.

00:25:05.800 --> 00:25:06.670
16 gigs.

00:25:06.670 --> 00:25:10.270
All right, that's
what's on my mine, too.

00:25:14.320 --> 00:25:19.570
16 gigabytes, which is 16 times
10 to the 9th bytes, roughly.

00:25:25.670 --> 00:25:28.340
So now we have to
say, all right,

00:25:28.340 --> 00:25:33.020
for storing n basis
times n basis numbers,

00:25:33.020 --> 00:25:35.370
how much does that take?

00:25:35.370 --> 00:25:46.260
Well, let's say that
we have a atoms.

00:25:46.260 --> 00:25:49.539
So we've got-- the number
of atoms we have is a.

00:25:49.539 --> 00:25:51.830
Then the number of basis
functions we have-- last time,

00:25:51.830 --> 00:25:53.810
we figured out that
a DZP basis, which

00:25:53.810 --> 00:25:57.660
is a decent-size basis
for carbon had around 15.

00:25:57.660 --> 00:25:59.270
It was 14 basis
functions per carbon.

00:25:59.270 --> 00:26:01.880
I'm just going round to 15
because it's easier math.

00:26:01.880 --> 00:26:05.060
So that means that the number
of basis functions is 15,

00:26:05.060 --> 00:26:07.320
roughly, times the
number of atoms.

00:26:07.320 --> 00:26:14.570
So there's 15a times
15a things that I need

00:26:14.570 --> 00:26:17.000
to store to get this matrix.

00:26:17.000 --> 00:26:23.460
And that means I need about
225 a squared numbers.

00:26:23.460 --> 00:26:26.360
So these are how many
numbers I have to store.

00:26:26.360 --> 00:26:30.434
And then I have to
know that each number--

00:26:30.434 --> 00:26:32.350
I'm usually storing these
in double precision.

00:26:32.350 --> 00:26:36.010
So each number requires eight
bytes in double precision.

00:26:36.010 --> 00:26:45.010
So that means that I have
something like 1,700 a squared

00:26:45.010 --> 00:26:47.170
bytes to store that object.

00:26:51.192 --> 00:26:52.900
So now that says, all
right, if I've only

00:26:52.900 --> 00:26:56.680
got 16 times 10 to the
9 bytes of storage space

00:26:56.680 --> 00:27:01.750
on my computer, and I need 1,700
a squared bytes for a molecule

00:27:01.750 --> 00:27:04.210
with a atoms, that just
gives me a natural limit

00:27:04.210 --> 00:27:05.680
on the number of atoms.

00:27:05.680 --> 00:27:10.030
If you back it out, that implies
that a is less than or about

00:27:10.030 --> 00:27:13.700
equal to 3,000, which
is a big number.

00:27:13.700 --> 00:27:17.200
So your molecule could have
up to about 3,000 atoms in it,

00:27:17.200 --> 00:27:19.069
and this calculation would run.

00:27:19.069 --> 00:27:21.360
And that rough calculation
turns out to be about right.

00:27:23.940 --> 00:27:28.420
Now let's take a look at
the CPU time required.

00:27:28.420 --> 00:27:32.190
So the CPU time, we're going
to measure this in hours,

00:27:32.190 --> 00:27:36.060
because that's my
human unit of time.

00:27:36.060 --> 00:27:41.950
So one hour is 3,600 seconds.

00:27:41.950 --> 00:27:45.100
And then what I need
to know is well,

00:27:45.100 --> 00:27:46.840
what actually takes
the computer time?

00:27:46.840 --> 00:27:49.810
What takes the computer time is
doing mathematical operations--

00:27:49.810 --> 00:27:55.060
so add, subtract, multiply,
divide, if, things like that.

00:27:55.060 --> 00:27:59.410
And usually, we measure
the speed of a CPU

00:27:59.410 --> 00:28:00.910
in terms of the
number of operations

00:28:00.910 --> 00:28:02.030
you can do per second.

00:28:02.030 --> 00:28:04.690
And does anybody know
the order of magnitude

00:28:04.690 --> 00:28:08.650
of operations per second the
CPU on your computer can do?

00:28:08.650 --> 00:28:10.230
It's about a billion--

00:28:10.230 --> 00:28:13.020
some number of billion
operations per second,

00:28:13.020 --> 00:28:14.930
depending on how recent
a model you have,

00:28:14.930 --> 00:28:19.190
and whether you play
video games or not,

00:28:19.190 --> 00:28:22.710
you will do more
or less than that.

00:28:22.710 --> 00:28:26.822
So that means that our computer,
in one hour, can do about one--

00:28:26.822 --> 00:28:28.530
and I'm going to round
up, and say you've

00:28:28.530 --> 00:28:29.210
got a really good one.

00:28:29.210 --> 00:28:31.170
So we're going to say
that your thing can do 10

00:28:31.170 --> 00:28:32.860
billion operations per second.

00:28:32.860 --> 00:28:36.180
If you've got multiple cores,
they can each go independently.

00:28:36.180 --> 00:28:42.130
So 1 times 10 to the 10
operations per second.

00:28:45.020 --> 00:28:48.710
And that means that you
can do about 3 times 10

00:28:48.710 --> 00:28:51.974
to 13 operations in an hour.

00:28:51.974 --> 00:28:54.140
I'm just going to set the
hour as my patience limit.

00:28:54.140 --> 00:28:56.930
I don't want to wait
longer than an hour.

00:28:56.930 --> 00:29:02.370
And so, then, for Hartree-Fock,
the rate-determining step

00:29:02.370 --> 00:29:05.788
is computing the eigenvalues
of the Hamiltonian.

00:29:10.090 --> 00:29:18.956
And that requires
n cubed operations,

00:29:18.956 --> 00:29:20.580
where n is the
dimension of the matrix.

00:29:20.580 --> 00:29:24.500
So if our matrix n basis on
a side, it requires n cubed--

00:29:24.500 --> 00:29:28.440
n basis functions
cubed operations.

00:29:28.440 --> 00:29:30.860
And so then, again, using
our translation of that

00:29:30.860 --> 00:29:35.360
into atoms, that's 15 times
the number of atoms cubed.

00:29:35.360 --> 00:29:38.060
Which, if I did my math
right back in my office,

00:29:38.060 --> 00:29:44.300
that's about 3,000 a cubed.

00:29:44.300 --> 00:29:46.220
And then if I back that out--

00:29:46.220 --> 00:29:50.580
again, if I compare that to
the number of operations,

00:29:50.580 --> 00:29:52.170
that gives me a
limit on the number

00:29:52.170 --> 00:29:54.360
of atoms that I can
handle in an hour,

00:29:54.360 --> 00:29:57.160
and that turns out
to be about 1,000.

00:29:57.160 --> 00:29:59.530
So similar sizes.

00:29:59.530 --> 00:30:01.680
So I run out of storage
about the same time

00:30:01.680 --> 00:30:03.839
as I run out of patience.

00:30:03.839 --> 00:30:05.880
If I was willing to be a
little bit more patient,

00:30:05.880 --> 00:30:08.400
I might be able
to do a few more.

00:30:08.400 --> 00:30:14.490
But order of magnitude,
we're at 1,000.

00:30:14.490 --> 00:30:15.420
So I'll summarize.

00:30:15.420 --> 00:30:20.110
What we found here is that
the storage requirements

00:30:20.110 --> 00:30:23.620
were something like a
squared of order a squared.

00:30:23.620 --> 00:30:27.620
CPU time was of order a cubed.

00:30:27.620 --> 00:30:30.060
The maximum feasible
number of basis functions

00:30:30.060 --> 00:30:34.740
that I could do
here was something

00:30:34.740 --> 00:30:37.500
like-- so if I have 1,000
atoms, that was my limit.

00:30:37.500 --> 00:30:40.950
Something like 15,000 would
be the maximum feasible

00:30:40.950 --> 00:30:43.110
number of basis functions.

00:30:43.110 --> 00:30:48.540
And maximum feasible number
of atoms was about 1,000.

00:30:48.540 --> 00:30:50.640
So we won't go through
the same exercise for MP2

00:30:50.640 --> 00:30:51.480
in such detail.

00:30:51.480 --> 00:30:55.492
I will just tell you that
everything is worse for MP2.

00:30:55.492 --> 00:30:57.450
Everything takes longer,
it takes more storage,

00:30:57.450 --> 00:30:58.590
everything's worse.

00:30:58.590 --> 00:31:04.090
So it requires order
a cubed storage.

00:31:04.090 --> 00:31:09.000
It requires order a
to the fifth CPU time.

00:31:09.000 --> 00:31:11.160
The maximum feasible
number of basis functions

00:31:11.160 --> 00:31:14.520
is therefore
smaller, about 2,000.

00:31:14.520 --> 00:31:18.270
And in MP2, you actually require
more basis functions per atom

00:31:18.270 --> 00:31:21.570
to get an accurate
answer, so that the number

00:31:21.570 --> 00:31:27.190
of feasible atoms is more
like 50 rather than 1,000.

00:31:27.190 --> 00:31:30.390
So that's the cumulative effect
of larger basis sets and worse

00:31:30.390 --> 00:31:35.650
scaling with number of atoms
that makes MP2 deal with much

00:31:35.650 --> 00:31:36.400
smaller systems.

00:31:39.330 --> 00:31:40.800
So questions about that.

00:31:44.981 --> 00:31:45.480
Yes.

00:31:45.480 --> 00:31:49.790
AUDIENCE: So what are some
examples of [INAUDIBLE]??

00:31:49.790 --> 00:31:53.360
TROY VAN VOORHIS:
So C60 is 60 atoms.

00:31:53.360 --> 00:31:55.710
That's an easy one.

00:31:55.710 --> 00:32:00.330
There are a number
of small dyes,

00:32:00.330 --> 00:32:03.210
for example, that we worked with
in our group, where you might

00:32:03.210 --> 00:32:05.293
have seen absorption
spectra, or emission spectra,

00:32:05.293 --> 00:32:07.320
or HOMOs, or LUMOs,
or hole transport

00:32:07.320 --> 00:32:10.050
properties, or electron
transport properties,

00:32:10.050 --> 00:32:12.750
that are around
50 atoms in size.

00:32:12.750 --> 00:32:15.330
And then the main thing that
people get interested in that

00:32:15.330 --> 00:32:21.360
are on the 1,000-atom regimes
are enzymes and peptides.

00:32:21.360 --> 00:32:22.480
Those are the sort of--

00:32:22.480 --> 00:32:24.480
when you start saying, I
want to do 1,000 atoms,

00:32:24.480 --> 00:32:29.105
it's usually because it's really
some polymer or heteropolymer.

00:32:31.777 --> 00:32:34.360
Another case where you also are
sometimes interested in things

00:32:34.360 --> 00:32:36.220
where you do simulations
with 1,000 atoms,

00:32:36.220 --> 00:32:37.700
if you're interested
in a surface.

00:32:37.700 --> 00:32:41.140
Because if you have a
chunk of gold, for example,

00:32:41.140 --> 00:32:43.450
1,000 atoms is just 10 gold
atoms, by 10 gold atoms,

00:32:43.450 --> 00:32:46.210
by 10 gold atoms, which is just
a little chunk-- a very, very

00:32:46.210 --> 00:32:48.040
small chunk of gold,
but still a chunk.

00:32:55.220 --> 00:32:56.408
Other questions.

00:33:00.160 --> 00:33:07.840
OK, so I'm going to spend seven
minutes talking about density

00:33:07.840 --> 00:33:08.890
functional theory.

00:33:08.890 --> 00:33:12.320
And then we're going to go
over and do some examples.

00:33:12.320 --> 00:33:15.160
So the idea of density
functional theory

00:33:15.160 --> 00:33:19.420
is that it'd be really nice
if you had some magical way

00:33:19.420 --> 00:33:20.800
to do a Hartree-Fock
calculation,

00:33:20.800 --> 00:33:23.980
but have a give you
exactly the right answer.

00:33:23.980 --> 00:33:26.650
That basically would be the
dream because we saw, well,

00:33:26.650 --> 00:33:29.080
for Hartree-Fock, we can
do big systems, it's cheap,

00:33:29.080 --> 00:33:31.480
it has good scaling, all
these kinds of things.

00:33:31.480 --> 00:33:33.450
It just doesn't give
us very good answers.

00:33:33.450 --> 00:33:35.025
The results are pretty poor.

00:33:35.025 --> 00:33:36.650
So what if we had
something that scaled

00:33:36.650 --> 00:33:38.774
like it had the computational
cost of Hartree-Fock,

00:33:38.774 --> 00:33:42.980
but was, say, the accuracy of
MP2, or even better than that?

00:33:42.980 --> 00:33:46.030
And so in density functional
theory, what we use

00:33:46.030 --> 00:33:51.700
is the idea of looking at
the electron density rho of r

00:33:51.700 --> 00:33:53.090
as the fundamental variable.

00:33:53.090 --> 00:33:56.350
So you can actually work
out, for a determinant,

00:33:56.350 --> 00:33:58.001
what the electron density is.

00:33:58.001 --> 00:33:59.500
And it's just the
sum of the squares

00:33:59.500 --> 00:34:01.321
of the orbital densities--

00:34:01.321 --> 00:34:02.820
or the sum of the
orbital densities.

00:34:02.820 --> 00:34:05.190
So you square each orbital,
then you add that up,

00:34:05.190 --> 00:34:08.530
and that gives you the
total electron density.

00:34:08.530 --> 00:34:10.360
It's basically just
the probability

00:34:10.360 --> 00:34:13.330
of finding an electron
at a point, r.

00:34:27.190 --> 00:34:29.400
OK, so that's a nice observable.

00:34:29.400 --> 00:34:31.139
The thing that's
kind of amazing is

00:34:31.139 --> 00:34:33.472
that there is a theorem, a
mathematical theorem that you

00:34:33.472 --> 00:34:36.389
can prove in about two pages
using just sort of proof

00:34:36.389 --> 00:34:37.620
by contradiction.

00:34:37.620 --> 00:34:42.630
You can prove that there exists
a functional, which is always

00:34:42.630 --> 00:34:46.650
given then in e
sub v of rho, such

00:34:46.650 --> 00:34:49.060
that when you're given the
ground state density, rho

00:34:49.060 --> 00:34:52.409
0, if you plug that into
this magical functional,

00:34:52.409 --> 00:34:54.219
it will give you the
ground state energy.

00:34:54.219 --> 00:34:56.280
So if you found the ground
state density lying around

00:34:56.280 --> 00:34:57.390
in the gutter, and
you picked it up,

00:34:57.390 --> 00:34:58.889
and you put it into
this functional,

00:34:58.889 --> 00:35:01.642
it would give you the
ground state energy.

00:35:01.642 --> 00:35:03.600
And e0 is not just the
approximate ground state

00:35:03.600 --> 00:35:04.100
energy.

00:35:04.100 --> 00:35:09.330
It is the exact ground state
energy, the exact thing.

00:35:09.330 --> 00:35:11.910
Further, for any
density, rho prime,

00:35:11.910 --> 00:35:13.950
that is not the
ground state density,

00:35:13.950 --> 00:35:18.740
if you plug that density into
eV, you get a higher energy.

00:35:18.740 --> 00:35:21.890
So what you could do is
you could say, well, let me

00:35:21.890 --> 00:35:23.150
just search.

00:35:23.150 --> 00:35:25.680
Let me try density, see
what energy it gives.

00:35:25.680 --> 00:35:26.930
Then I'll try another density.

00:35:26.930 --> 00:35:29.200
If it gives a lower energy,
that's a better density.

00:35:29.200 --> 00:35:31.741
And I'll keep going, and going,
and going, and going, until I

00:35:31.741 --> 00:35:34.470
find that ground state density.

00:35:34.470 --> 00:35:36.480
So the idea is that
then you would say, aha,

00:35:36.480 --> 00:35:44.384
if I solve that equation--
so I search over densities,

00:35:44.384 --> 00:35:46.300
and that's not going to
be a very hard search,

00:35:46.300 --> 00:35:48.790
because the density is just
a three-dimensional object.

00:35:48.790 --> 00:35:50.200
It's not like the wave
function that depends

00:35:50.200 --> 00:35:51.283
on a bunch of coordinates.

00:35:51.283 --> 00:35:53.120
It's just three dimensional.

00:35:53.120 --> 00:35:56.910
So I solve that equation,
that will give me rho 0.

00:35:56.910 --> 00:36:02.100
And then I can take that rho
0, plug it back in there,

00:36:02.100 --> 00:36:05.090
and I will get the
ground state energy.

00:36:05.090 --> 00:36:08.161
That gives me a closed
set of conditions

00:36:08.161 --> 00:36:09.910
that lets me find the
ground state energy,

00:36:09.910 --> 00:36:13.176
and then report back the
energy of that density.

00:36:13.176 --> 00:36:15.050
AUDIENCE: Where do we
get this [? EV ?] from?

00:36:15.050 --> 00:36:16.800
TROY VAN VOORHIS:
That's a great question.

00:36:16.800 --> 00:36:18.480
The proof is a proof
by contradiction.

00:36:18.480 --> 00:36:19.470
It's not constructive.

00:36:19.470 --> 00:36:21.290
It proves that it
exists, but gives you

00:36:21.290 --> 00:36:23.880
no way of constructing it.

00:36:23.880 --> 00:36:27.932
So kind of the frustrating thing
is like, oh, cookies exist,

00:36:27.932 --> 00:36:29.390
but we don't know
how to make them.

00:36:33.370 --> 00:36:35.930
But the idea that
such a thing exists

00:36:35.930 --> 00:36:37.737
gives you hope to
say, well, maybe

00:36:37.737 --> 00:36:39.820
we can construct-- if we
can't find the exact one,

00:36:39.820 --> 00:36:42.920
maybe we can find one
that's very, very good.

00:36:42.920 --> 00:36:46.010
And that one that's very
good, we would just use.

00:36:46.010 --> 00:36:48.319
We would pretend it was
exact, minimize the energy,

00:36:48.319 --> 00:36:50.360
find the density, and then
report back the ground

00:36:50.360 --> 00:36:52.070
state for that approximating.

00:36:52.070 --> 00:36:55.220
And that's actually what you do
in density functional theory.

00:36:55.220 --> 00:36:57.458
You have approximate
functionals.

00:37:04.430 --> 00:37:06.740
And they're all-- just
like with basis sets--

00:37:06.740 --> 00:37:09.650
named after the authors of the
people who wrote the papers.

00:37:09.650 --> 00:37:11.480
Almost all of them are.

00:37:11.480 --> 00:37:17.420
So there's the Local Spin
Density Approximation, LSDA.

00:37:17.420 --> 00:37:20.840
There's the
Perdew-Burke-Ernzerhof

00:37:20.840 --> 00:37:22.940
functional.

00:37:22.940 --> 00:37:30.170
There's the
Becke-Lee-Yang-Parr functional,

00:37:30.170 --> 00:37:34.910
the Perdew-Burke-Ernzerhof
Zero functional,

00:37:34.910 --> 00:37:39.840
the Becke 3
Lee-Yang-Parr functional,

00:37:39.840 --> 00:37:41.791
and then on and on and on.

00:37:41.791 --> 00:37:43.290
Now these things
have been sort of--

00:37:43.290 --> 00:37:45.330
there's a mishmash of
different exact conditions

00:37:45.330 --> 00:37:48.270
that were used to derive
these functionals.

00:37:48.270 --> 00:37:51.570
And then, empirically,
people have gone and shown

00:37:51.570 --> 00:37:55.110
that PBE is better than LSDA.

00:37:55.110 --> 00:37:57.300
It's about as good as BLYP.

00:37:57.300 --> 00:38:01.190
BLYP is not as good as PBE0,
but it was just about as good

00:38:01.190 --> 00:38:01.690
as B3LYP.

00:38:04.760 --> 00:38:06.150
So we have, then,
sort of an idea

00:38:06.150 --> 00:38:08.970
that, OK, if we go over towards
the right-hand side of this,

00:38:08.970 --> 00:38:11.730
we're going to get better
results out of DFT.

00:38:11.730 --> 00:38:14.760
But DFT, because it's based
off of a Slater determinant,

00:38:14.760 --> 00:38:16.920
has exactly the same
computational scaling,

00:38:16.920 --> 00:38:19.090
and storage, and
everything, as Hartree-Fock.

00:38:19.090 --> 00:38:20.760
It's the same kind of expense.

00:38:20.760 --> 00:38:22.740
But if I go back to
this accuracy thing,

00:38:22.740 --> 00:38:26.530
and I say, well, what
would I get from that best

00:38:26.530 --> 00:38:34.060
density functional
B3LYP, well what

00:38:34.060 --> 00:38:36.880
I find is that activation
energies are still a little bit

00:38:36.880 --> 00:38:40.700
difficult. Now I underpredict
activation energies.

00:38:40.700 --> 00:38:44.400
But my dipole moments are good.

00:38:44.400 --> 00:38:48.170
My sizes are again accurate.

00:38:48.170 --> 00:38:55.010
My absorption energies are
just as accurate as MP2,

00:38:55.010 --> 00:38:57.300
and my bond lengths are
just as accurate as MP2.

00:39:00.660 --> 00:39:02.550
There are other things,
but basically B3LYP

00:39:02.550 --> 00:39:05.010
is as accurate or
more accurate than MP2

00:39:05.010 --> 00:39:07.470
for virtually every property
you would want, but has

00:39:07.470 --> 00:39:09.399
Hartree-Fock-like cost.

00:39:09.399 --> 00:39:11.190
And so that makes
density functional theory

00:39:11.190 --> 00:39:14.310
the workhorse of computational
chemistry these days.

00:39:14.310 --> 00:39:17.250
Because it's inexpensive, you
can do lots of calculations

00:39:17.250 --> 00:39:25.014
with it, but it's accurate
enough for grunt work.

00:39:25.014 --> 00:39:27.430
And then there's a blank column
there that, if I had time,

00:39:27.430 --> 00:39:28.590
I would talk about.

00:39:28.590 --> 00:39:29.830
There's a whole other
category of things

00:39:29.830 --> 00:39:31.829
where you say, well,
perturbation theory doesn't

00:39:31.829 --> 00:39:35.220
work, but are there
more constructive ways

00:39:35.220 --> 00:39:38.250
that I could use wave functions
to approximate the correlation

00:39:38.250 --> 00:39:39.280
energy?

00:39:39.280 --> 00:39:41.370
And the answer is yes,
you can get good energies

00:39:41.370 --> 00:39:42.547
and good answers out.

00:39:42.547 --> 00:39:44.880
But then it comes at the cost
of the calculation getting

00:39:44.880 --> 00:39:46.480
much more expensive.

00:39:46.480 --> 00:39:49.530
So there are methods that
improve all these properties

00:39:49.530 --> 00:39:52.154
on the wave function side,
that just require more.

00:39:52.154 --> 00:39:53.820
So if you want to
know more about those,

00:39:53.820 --> 00:39:56.040
they're in the notes.

00:39:56.040 --> 00:40:02.980
And so now I think I will
switch over and show you how we

00:40:02.980 --> 00:40:04.650
do some calculations with this.

00:40:04.650 --> 00:40:08.831
So now I will switch.

00:40:08.831 --> 00:40:10.330
There's two different
tools that you

00:40:10.330 --> 00:40:12.820
have available to you
for free on Athena

00:40:12.820 --> 00:40:15.819
that you can use to do
electronic structure

00:40:15.819 --> 00:40:16.360
calculations.

00:40:16.360 --> 00:40:19.384
One is Gaussian, and
the other one is Q-Chem.

00:40:19.384 --> 00:40:20.800
There may be even
some other ones,

00:40:20.800 --> 00:40:22.758
but those are the two
that I've collected notes

00:40:22.758 --> 00:40:24.470
about how to use.

00:40:24.470 --> 00:40:26.290
So I'm going to show
you how we use Q-Chem.

00:40:26.290 --> 00:40:27.664
I'm not going to
do it on Athena.

00:40:27.664 --> 00:40:30.290
I'm going to do it on my laptop,
but it's basically the same.

00:40:30.290 --> 00:40:32.065
So there's this
GUI called IQmol.

00:40:35.410 --> 00:40:38.920
And when you open
it up, it gives you

00:40:38.920 --> 00:40:43.020
a window that looks like this.

00:40:43.020 --> 00:40:44.970
And there's a few things here.

00:40:44.970 --> 00:40:48.660
So there's, like, an open
file, you can create something,

00:40:48.660 --> 00:40:51.870
you can open a file,
you can save something,

00:40:51.870 --> 00:40:54.960
you can move something
around after you've built it.

00:40:54.960 --> 00:40:58.260
And then these are the
build tools over here.

00:40:58.260 --> 00:41:01.290
So that just turns
it into build mode.

00:41:01.290 --> 00:41:04.290
If I click on this, I can choose
any item in the periodic table.

00:41:04.290 --> 00:41:06.600
Right now, it's on carbon.

00:41:06.600 --> 00:41:11.180
This lets me select
various fragments,

00:41:11.180 --> 00:41:13.230
and also what the attach
point of the fragment's

00:41:13.230 --> 00:41:16.452
going to be in some cases.

00:41:16.452 --> 00:41:18.660
And I don't want to do it,
so I'll select it for now,

00:41:18.660 --> 00:41:21.000
but then I'm going to
go back to this one.

00:41:21.000 --> 00:41:23.260
This is the Add
Hydrogens button.

00:41:23.260 --> 00:41:24.640
So if you have something that--

00:41:24.640 --> 00:41:26.140
you just wrote your
Lewis structure,

00:41:26.140 --> 00:41:28.230
it had no hydrogens in
it, you click that button,

00:41:28.230 --> 00:41:30.510
it'll put all the hydrogens
where they should be,

00:41:30.510 --> 00:41:32.170
or where it thinks
they should be.

00:41:32.170 --> 00:41:34.920
This is a Minimize
Energy thing, which

00:41:34.920 --> 00:41:37.110
basically if your structure
looks really crazy,

00:41:37.110 --> 00:41:40.140
it'll kind of make
it look less crazy.

00:41:40.140 --> 00:41:44.370
And then this is the
Select button, which

00:41:44.370 --> 00:41:45.550
lets you pick certain atoms.

00:41:45.550 --> 00:41:48.900
This lets you delete certain
atoms, take a picture,

00:41:48.900 --> 00:41:50.702
do a movie.

00:41:50.702 --> 00:41:53.055
And then that changes it
over to fullscreen mode.

00:41:53.055 --> 00:41:57.170
And that's the life
preserver for Help.

00:41:57.170 --> 00:41:58.860
But we'll do
building a molecule.

00:41:58.860 --> 00:42:01.440
So does somebody want to
tell me a molecule that

00:42:01.440 --> 00:42:04.410
has less than 15
atoms in it that they

00:42:04.410 --> 00:42:09.590
would like me to draw here,
that I can actually draw?

00:42:09.590 --> 00:42:10.940
AUDIENCE: Diethyl ether.

00:42:10.940 --> 00:42:12.969
TROY VAN VOORHIS: Diethyl ether.

00:42:12.969 --> 00:42:13.760
Yes, I can do that.

00:42:13.760 --> 00:42:15.660
OK.

00:42:15.660 --> 00:42:20.340
All right, so put
a carbon, carbon,

00:42:20.340 --> 00:42:31.940
then I got to switch to an
oxygen, oxygen, carbon, carbon.

00:42:31.940 --> 00:42:36.426
And then I will click
the Add Hydrogen button.

00:42:36.426 --> 00:42:38.790
[LAUGHTER]

00:42:38.790 --> 00:42:39.750
There we go.

00:42:39.750 --> 00:42:43.410
I've got my diethyl ether now.

00:42:43.410 --> 00:42:46.400
And while my geometry
here is not perfect,

00:42:46.400 --> 00:42:47.720
it doesn't look totally crazy.

00:42:47.720 --> 00:42:49.190
So I'll just go with that.

00:42:49.190 --> 00:42:50.690
And then the thing
we're going to be

00:42:50.690 --> 00:42:52.640
most interested in is
this little tab here,

00:42:52.640 --> 00:42:54.290
called Calculation.

00:42:54.290 --> 00:42:58.040
So calculation here has a little
button that says Q-Chem Setup.

00:42:58.040 --> 00:43:01.520
So I'll do Q-Chem Setup.

00:43:01.520 --> 00:43:04.745
And now it's got a bunch of
things that I can specify.

00:43:07.302 --> 00:43:09.260
There are a few things
that are most important.

00:43:09.260 --> 00:43:13.361
So the first thing is, what kind
of calculation I want it to do.

00:43:13.361 --> 00:43:15.110
So I could have it
just compute the energy

00:43:15.110 --> 00:43:17.960
of the molecule for the
configuration I specified.

00:43:17.960 --> 00:43:20.390
That would be one useful thing.

00:43:20.390 --> 00:43:21.870
I could compute forces.

00:43:21.870 --> 00:43:23.540
In other words, the
forces on the atoms,

00:43:23.540 --> 00:43:25.640
where the atoms want to move.

00:43:25.640 --> 00:43:28.850
I could optimize the
geometry, which would then

00:43:28.850 --> 00:43:33.230
relax the thing down, and figure
out what the best geometry is.

00:43:33.230 --> 00:43:34.820
I could do various
things that scan

00:43:34.820 --> 00:43:36.800
across the potential
energy surface.

00:43:36.800 --> 00:43:39.340
I can compute
vibrational frequencies.

00:43:39.340 --> 00:43:41.810
I can compute NMR
chemical shifts.

00:43:41.810 --> 00:43:45.110
I can do molecular dynamics.

00:43:45.110 --> 00:43:47.780
I can compute properties--

00:43:47.780 --> 00:43:48.594
so lots of things.

00:43:48.594 --> 00:43:50.260
I'm just going to
optimize the geometry.

00:43:50.260 --> 00:43:52.860
That's going to be what I'm
going to choose for now.

00:43:52.860 --> 00:43:55.140
And then I get to
choose a method.

00:43:55.140 --> 00:43:57.170
So I can do Hartree-Fock.

00:43:57.170 --> 00:43:59.680
I can do B3LYP.

00:43:59.680 --> 00:44:03.260
I can go down-- so all the
things above this dotted line

00:44:03.260 --> 00:44:06.560
here are different
density functions.

00:44:06.560 --> 00:44:11.450
And then, down here, we've
got MP2, MP2 bracket v--

00:44:11.450 --> 00:44:13.760
I'm not actually
sure what that is.

00:44:13.760 --> 00:44:18.020
I've got various versions of
MP2 that try to make it faster.

00:44:18.020 --> 00:44:20.630
And then I've got a
couple of cluster methods

00:44:20.630 --> 00:44:23.090
that we didn't talk about yet,
but that are in the notes.

00:44:23.090 --> 00:44:24.590
And then various
methods for getting

00:44:24.590 --> 00:44:27.540
electronic excited states,
down here at the bottom.

00:44:27.540 --> 00:44:30.920
So for now, let's just
do B3LYP, and then I

00:44:30.920 --> 00:44:32.420
get to choose a basis.

00:44:32.420 --> 00:44:34.900
Because this is on my
laptop, and we're in class,

00:44:34.900 --> 00:44:36.600
I'm going to choose
a small basis.

00:44:36.600 --> 00:44:41.420
So I'm going to leave it at
321g, which is a small basis.

00:44:41.420 --> 00:44:44.840
And then I can also
specify the charge, which

00:44:44.840 --> 00:44:46.940
is like the total
charge of the molecule,

00:44:46.940 --> 00:44:48.210
and the spin multiplicity.

00:44:48.210 --> 00:44:52.190
So I want it to be a
neutral molecule, spin 1--

00:44:52.190 --> 00:44:55.910
or spin multiplicity
1, which is spin 0.

00:44:55.910 --> 00:45:00.920
Because it's 2s plus 1
is the spin multiplicity.

00:45:00.920 --> 00:45:03.460
And then there's various things
about convergence control

00:45:03.460 --> 00:45:05.293
that you probably won't
need to worry about.

00:45:05.293 --> 00:45:07.610
And then there's advanced
things that you also probably

00:45:07.610 --> 00:45:09.170
won't need to worry about.

00:45:09.170 --> 00:45:11.630
So now I'm happy with that.

00:45:11.630 --> 00:45:14.280
I can submit my job.

00:45:14.280 --> 00:45:23.420
And I will call this
diethyl ether, hit OK.

00:45:23.420 --> 00:45:26.650
And now it doesn't appear
to be doing anything.

00:45:26.650 --> 00:45:30.102
In the background, it
is doing something.

00:45:30.102 --> 00:45:32.060
I think this will finish
in just a few seconds,

00:45:32.060 --> 00:45:35.890
but if you get concerned that
the job might not be running

00:45:35.890 --> 00:45:37.340
or something might
have happened,

00:45:37.340 --> 00:45:39.607
you can go over to
the Job Monitor.

00:45:39.607 --> 00:45:41.690
Methane-- that was the job
that I ran this morning

00:45:41.690 --> 00:45:42.815
to make sure that it works.

00:45:42.815 --> 00:45:47.455
Diethyl ether, we just submitted
it at 10:50 and 21 seconds.

00:45:47.455 --> 00:45:48.300
Ah, there we go.

00:45:48.300 --> 00:45:49.924
Now it's been running
for four seconds.

00:45:52.174 --> 00:45:53.340
Let's see how long it takes.

00:45:59.610 --> 00:46:02.200
OK, it's taking a lot
longer than I think.

00:46:02.200 --> 00:46:02.967
All right.

00:46:02.967 --> 00:46:06.240
AUDIENCE: They close
[? in 15 ?] [INAUDIBLE]..

00:46:06.240 --> 00:46:08.426
TROY VAN VOORHIS:
That's all right.

00:46:08.426 --> 00:46:09.800
We still we've
got a few minutes.

00:46:09.800 --> 00:46:13.210
So what will happen here
in a minute, when we--

00:46:13.210 --> 00:46:15.872
AUDIENCE: [INAUDIBLE].

00:46:15.872 --> 00:46:17.330
TROY VAN VOORHIS:
That's all right.

00:46:20.960 --> 00:46:22.660
It's going along.

00:46:22.660 --> 00:46:24.150
So when it's done,
what will happen

00:46:24.150 --> 00:46:26.790
is, over here,
it'll let us know.

00:46:26.790 --> 00:46:29.070
And over here will
appear a thing

00:46:29.070 --> 00:46:31.189
where we can start
looking at the results.

00:46:31.189 --> 00:46:33.480
It might have gone faster if
I had minimized the energy

00:46:33.480 --> 00:46:35.980
to begin with, because then it
would do less geometry steps.

00:46:38.775 --> 00:46:40.879
It's going along.

00:46:40.879 --> 00:46:41.420
I don't know.

00:46:41.420 --> 00:46:43.503
We might run out of class
time before it finishes.

00:46:43.503 --> 00:46:44.270
It's 10:51.

00:46:44.270 --> 00:46:45.260
We've got four minutes.

00:46:45.260 --> 00:46:47.390
Let's see.

00:46:47.390 --> 00:46:48.290
Come on, laptop.

00:46:48.290 --> 00:46:50.950
I've got the MacBook Pro.

00:46:50.950 --> 00:46:54.534
Maybe I should have upgraded the
processor, this kind of thing.

00:46:54.534 --> 00:46:55.980
AUDIENCE: How long
do you usually

00:46:55.980 --> 00:46:57.910
let your group
calculations go for?

00:46:57.910 --> 00:46:59.784
TROY VAN VOORHIS: Well,
in my research group,

00:46:59.784 --> 00:47:03.907
we have 1,000 cores that we--

00:47:03.907 --> 00:47:05.990
maybe around 1,200 cores,
even, I think, actually.

00:47:05.990 --> 00:47:06.470
Oh, there we go.

00:47:06.470 --> 00:47:06.970
It finished.

00:47:06.970 --> 00:47:09.720
But we have around 1,200
cores for around 10 people.

00:47:09.720 --> 00:47:13.700
So that means that you can let
a job run for a very, very, very

00:47:13.700 --> 00:47:15.860
long time, on
multiple cores, and it

00:47:15.860 --> 00:47:17.630
doesn't get in anyone's way.

00:47:17.630 --> 00:47:22.520
So it's not unusual for us to
put something in there that

00:47:22.520 --> 00:47:25.070
lasts a week.

00:47:25.070 --> 00:47:26.090
So now it's finished.

00:47:26.090 --> 00:47:27.923
We want to copy the
results from the server.

00:47:27.923 --> 00:47:31.580
This is an arcane
way of saying things.

00:47:31.580 --> 00:47:34.580
Because it's designed
for supercomputers, where

00:47:34.580 --> 00:47:37.520
you are sitting at a
terminal in your office,

00:47:37.520 --> 00:47:39.504
and then it sends
all the results over

00:47:39.504 --> 00:47:41.420
to the supercomputer,
it runs the calculation,

00:47:41.420 --> 00:47:42.770
and then you have to
copy the results back

00:47:42.770 --> 00:47:44.032
to your little computer.

00:47:44.032 --> 00:47:45.740
I was actually running
it on my computer.

00:47:45.740 --> 00:47:49.180
It's just the computer is both--

00:47:49.180 --> 00:47:50.230
I'll just put it--

00:47:53.674 --> 00:47:54.658
New Folder.

00:48:03.014 --> 00:48:03.514
OK.

00:48:08.861 --> 00:48:09.360
There we go.

00:48:09.360 --> 00:48:11.516
Now it has a little star
next to it, which lets

00:48:11.516 --> 00:48:12.640
me know that it's finished.

00:48:12.640 --> 00:48:14.130
So let's see, Info--

00:48:14.130 --> 00:48:16.450
so I can show the dipole moment.

00:48:16.450 --> 00:48:18.720
So there we go, that
little blue arrow--

00:48:18.720 --> 00:48:20.880
which, magnitude and
direction is the dipole moment

00:48:20.880 --> 00:48:21.990
of diethyl ether.

00:48:21.990 --> 00:48:25.936
It does have a dipole moment,
with its positive end here,

00:48:25.936 --> 00:48:27.060
pointing in that direction.

00:48:27.060 --> 00:48:28.860
That seems about right.

00:48:28.860 --> 00:48:30.300
Let's see.

00:48:30.300 --> 00:48:31.617
I can look at the files.

00:48:31.617 --> 00:48:34.200
These are only if you're really,
really interested in details.

00:48:34.200 --> 00:48:35.460
You see these are very verbose.

00:48:35.460 --> 00:48:36.876
They have every
bit of information

00:48:36.876 --> 00:48:38.600
you could possibly want in them.

00:48:38.600 --> 00:48:40.725
So if there's ever something
that you can't get out

00:48:40.725 --> 00:48:42.750
of the GUI, if you
just kind of go--

00:48:42.750 --> 00:48:43.890
you can search.

00:48:43.890 --> 00:48:47.122
And I can look for converge.

00:48:47.122 --> 00:48:49.240
Oh, look, optimization
converged, and then it

00:48:49.240 --> 00:48:52.460
tells me everything after that.

00:48:52.460 --> 00:48:54.680
I can look at the different
atoms in the molecule,

00:48:54.680 --> 00:48:56.480
and it will highlight
them for me.

00:48:59.420 --> 00:49:02.532
And then I can look at
bonds, and it will tell me--

00:49:02.532 --> 00:49:04.490
I don't if you guys can
read, but down here, it

00:49:04.490 --> 00:49:06.110
has the bond length
in the corner.

00:49:06.110 --> 00:49:08.330
So that C-H bond is 1.093.

00:49:08.330 --> 00:49:13.260
All these C-H bonds are going
to be 1.09, plus or minus a bit.

00:49:13.260 --> 00:49:17.940
The carbon-oxygen bond
there is 1.46, rounding.

00:49:17.940 --> 00:49:20.870
That one is also 1.46.

00:49:20.870 --> 00:49:26.940
And then this here-- so as it
did the geometry optimization,

00:49:26.940 --> 00:49:30.150
it was adjusting the geometry
trying to find the minimum.

00:49:30.150 --> 00:49:32.190
And these are the
different total energies

00:49:32.190 --> 00:49:34.320
that it had as it went
through the optimization.

00:49:34.320 --> 00:49:36.430
You'll see that eventually
it sort of slows down.

00:49:36.430 --> 00:49:37.980
The energy is going
down every time,

00:49:37.980 --> 00:49:39.450
and eventually it sort
of slows down to where

00:49:39.450 --> 00:49:40.574
it's not changing any more.

00:49:40.574 --> 00:49:42.270
It says, all right,
that's the minimum.

00:49:42.270 --> 00:49:46.120
You also notice that
these are in atomic units.

00:49:46.120 --> 00:49:49.590
So that's minus 232 Hartrees.

00:49:49.590 --> 00:49:52.620
So that's like 4,000 kcals.

00:49:52.620 --> 00:49:54.390
No, that's more
than 4,000 kcals.

00:49:54.390 --> 00:49:56.976
Anyway, it's tens of
thousands of kcals.

00:49:56.976 --> 00:49:58.350
The reason it's
such a low number

00:49:58.350 --> 00:50:01.200
is this is the energy it would
take to rip every electron off

00:50:01.200 --> 00:50:04.620
of the molecule, including
all of the 1s electrons.

00:50:04.620 --> 00:50:06.630
So the energies
are typically going

00:50:06.630 --> 00:50:08.522
to be very, very large
negative numbers.

00:50:08.522 --> 00:50:09.480
Don't worry about that.

00:50:09.480 --> 00:50:12.660
It's energy differences
that matter.

00:50:12.660 --> 00:50:16.840
So you notice, even my bad
geometry was already 232.1.

00:50:16.840 --> 00:50:18.780
The correct answer is 232.3.

00:50:18.780 --> 00:50:21.132
So the total energy
change wasn't that much.

00:50:21.132 --> 00:50:22.590
And then the last
cool thing that I

00:50:22.590 --> 00:50:25.740
want to show you is that
we can plot orbitals.

00:50:29.435 --> 00:50:35.360
So I'm going to
count some orbitals.

00:50:35.360 --> 00:50:35.880
There we go.

00:50:35.880 --> 00:50:38.136
So I just had to calculate
the HOMO and the LUMO.

00:50:38.136 --> 00:50:39.760
I didn't go through
all of it with you.

00:50:39.760 --> 00:50:42.425
But if you go there, it
gives you some things--

00:50:42.425 --> 00:50:44.300
I should actually go
back and look, show you.

00:50:44.300 --> 00:50:47.180
So you get to choose
a range of orbitals.

00:50:47.180 --> 00:50:50.100
The iso value is basically
where it draws the surface.

00:50:50.100 --> 00:50:51.670
So it's inverse of
what you expect.

00:50:51.670 --> 00:50:54.709
A larger iso value is--
it's an isosurface,

00:50:54.709 --> 00:50:56.750
so if you make it larger,
the place where the iso

00:50:56.750 --> 00:50:58.750
value is larger is closer in.

00:50:58.750 --> 00:51:00.290
So it makes a smaller bubble.

00:51:00.290 --> 00:51:02.626
And a smaller iso value
makes a bigger bubble.

00:51:02.626 --> 00:51:04.250
And you can change
the number of points

00:51:04.250 --> 00:51:07.400
that it samples to make the
surface, change the colors,

00:51:07.400 --> 00:51:09.530
change the opacity
of it in terms

00:51:09.530 --> 00:51:12.232
of how you want it to look.

00:51:12.232 --> 00:51:13.190
But I already did this.

00:51:13.190 --> 00:51:17.100
So there is the HOMO.

00:51:17.100 --> 00:51:23.230
So the HOMO is something
in the pi manifold.

00:51:23.230 --> 00:51:27.850
It's pi star here.

00:51:27.850 --> 00:51:30.944
And then I can take out
the HOMO and show the LUMO.

00:51:30.944 --> 00:51:32.860
And the LUMO is, in this
particular basis set,

00:51:32.860 --> 00:51:36.320
not very useful, because I don't
have a lot of basis functions.

00:51:36.320 --> 00:51:40.000
So my basis functions, just
there's not enough of them

00:51:40.000 --> 00:51:42.844
to really describe the
LUMO, or the LUMO plus 1.

00:51:42.844 --> 00:51:44.260
If I want to get
a LUMO, we'd need

00:51:44.260 --> 00:51:47.209
a bigger basis set than this.

00:51:47.209 --> 00:51:49.000
So that's the kind of
thing that you can do

00:51:49.000 --> 00:51:51.340
with Q-Chem or with Gaussian.

00:51:51.340 --> 00:51:54.220
Gaussian has a GUI
called GaussView.

00:51:54.220 --> 00:51:55.526
You can use either one.

00:51:55.526 --> 00:51:57.900
But they both work pretty
well, and are pretty intuitive.

00:51:57.900 --> 00:51:59.590
And so I think, on
the next problem set,

00:51:59.590 --> 00:52:02.290
you will have some
homework problems

00:52:02.290 --> 00:52:05.420
that involve running some
calculations with these things.

00:52:05.420 --> 00:52:06.640
And I hope you enjoy it.

00:52:06.640 --> 00:52:09.140
Well, I don't know if homework
is ever really enjoyable.

00:52:09.140 --> 00:52:12.428
But I hope it's marginally
enjoyable anyway.

